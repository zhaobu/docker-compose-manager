version: "3.7"
services:
  # 局域网dns服务器
  # coredns:
  #   image: coredns/coredns
  #   container_name: coredns
  #   restart: always
  #   volumes:
  #     - ./coredns/Corefile.conf:/etc/coredns/Corefile.conf
  #   ports:
  #     - 53:53/udp
  #     - 53:53/tcp
  #   command: ["-conf", "/etc/coredns/Corefile.conf"]
  #   networks:
  #     - docker_manger

  # 内网穿透
  nps_server:
    image: ffdfgdfg/nps:0.26.1
    container_name: nps_server
    restart: always
    ports:
      - 55600:8080
      #  暴露对外client连接端口
      - 55601:8024
      - 55602:80
      - 55603-55699:55603-55699
    networks:
      - docker_manger
    volumes:
      - ./nps/server/conf/:/conf
      # - ./nps/server/logs/:/nps/logs/
  # docker 可视化管理
  portainer:
    image: portainer/portainer:latest
    container_name: portainer
    restart: always
    ports:
      - 55700:9000
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock
      - portainerdata:/data
    networks:
      - docker_manger

networks:
  docker_manger:
    external: false
    name: docker_manger

volumes:
  portainerdata:
    name: portainerdata
